<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>モード選択｜棚↔型 QR</title>
<style>
  :root{
    --bg:#0b7285; --panel:#ffffff; --txt:#1f2937;
    --primary:#0ea5e9; --primary-2:#0284c7;
    --ok:#2a9d8f; --warn:#f59f00;
    --bd:#d0d7de; --shadow:rgba(0,0,0,.15);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
    color:var(--txt); background:linear-gradient(135deg,#0b7285,#0ea5e9);
    display:grid; place-items:center; padding:24px;
  }
  .card{
    width:min(860px,100%); background:var(--panel); border:1px solid var(--bd);
    border-radius:18px; box-shadow:0 16px 40px var(--shadow); padding:24px;
  }
  h1{margin:0 0 6px; font-size:clamp(22px,3.2vw,30px); letter-spacing:.02em;}
  p.sub{margin:0 0 18px; color:#64748b; font-size:14px}
  .grid{
    display:grid; grid-template-columns:1fr; gap:16px;
  }
  @media (min-width:720px){ .grid{ grid-template-columns:1fr 1fr; } }
  .btn{
    display:flex; gap:14px; align-items:center; justify-content:center;
    border:1px solid var(--bd); border-radius:14px; padding:22px 18px;
    background:#fff; cursor:pointer; text-decoration:none; color:inherit;
    transition:.18s transform ease, .18s box-shadow ease, .18s border-color ease, .18s background-color ease;
    box-shadow:0 6px 18px rgba(2,132,199,.12);
    min-height:110px;
  }
  .btn:hover{ transform:translateY(-2px); box-shadow:0 10px 22px rgba(2,132,199,.18); border-color:#b6c2cc; }
  .btn .icon{
    width:44px; height:44px; flex:0 0 44px; border-radius:12px; display:grid; place-items:center; color:#fff;
  }
  .btn .txt{display:flex; flex-direction:column; gap:6px}
  .btn .txt .ttl{font-weight:800; letter-spacing:.02em; font-size:20px}
  .btn .txt .desc{color:#6b7280; font-size:13px; line-height:1.45}
  .btn.reg .icon{background:linear-gradient(135deg, var(--ok), #52b788)}
  .btn.inq .icon{background:linear-gradient(135deg, var(--primary), var(--primary-2))}
  .foot{margin-top:14px; display:flex; justify-content:space-between; align-items:center; color:#6b7280; font-size:12px}
  .mini{display:flex; gap:8px; align-items:center}
  .mini code{background:#f1f5f9; padding:2px 6px; border-radius:6px}
</style>
</head>
<body>
  <main class="card">
    <h1>モードを選択してください</h1>
    <p class="sub">登録（棚に型を登録）／ 照会（指示QRでターゲット指定し現物を探す）</p>

    <div class="grid">
      <!-- 登録モード: 既存の “棚→型 QRスキャン登録_air_off_deep” をそのまま開く -->
      <a class="btn reg" href="./scan-register.html">
        <span class="icon" aria-hidden="true">
          <!-- upload icon -->
          <svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </span>
        <span class="txt">
          <span class="ttl">登録モード（棚→型）</span>
          <span class="desc">棚QRを固定 → 型QRを複数読み → Googleシート（＋Airtableは設定次第）に一括登録</span>
        </span>
      </a>

      <!-- 照会モード: 以前の “抜型ファインダー deep” を別ファイルで -->
      <a class="btn inq" href="./scan-lookup.html">
        <span class="icon" aria-hidden="true">
          <!-- search icon -->
          <svg viewBox="0 0 24 24" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </span>
        <span class="txt">
          <span class="ttl">照会モード（型さがし）</span>
          <span class="desc">order_QR（作業指示）を読みターゲット設定 → 現場で die / loc をスキャンして一致を判定</span>
        </span>
      </a>
    </div>

    <div class="foot">
      <div class="mini">ショートカット：<code>1</code> 登録 / <code>2</code> 照会</div>
      <div class="mini">最後に開いたモードを記憶します</div>
    </div>
  </main>

<script>
  // 最後に選んだモードへ自動提案（2回目以降に軽く効く）
  const LAST_KEY = "qr-mode-last";
  const links = {
    register: "./scan-register.html", // ← 実ファイル名に合わせてください
    lookup:   "./scan-lookup.html"    // ← 実ファイル名に合わせてください
  };

  // 1/2 キーで起動
  window.addEventListener('keydown', (e)=>{
    if(e.key === '1'){ go('register'); }
    if(e.key === '2'){ go('lookup'); }
  });

  // 初回は何もしない。必要なら “自動遷移しないが、右上にトースト表示”等に変えられます
  function go(mode){
    localStorage.setItem(LAST_KEY, mode);
    location.href = links[mode] || "./";
  }

  // ボタンのクリックで記録
  document.querySelector('.btn.reg')?.addEventListener('click', ()=>localStorage.setItem(LAST_KEY,'register'));
  document.querySelector('.btn.inq')?.addEventListener('click', ()=>localStorage.setItem(LAST_KEY,'lookup'));
</script>
</body>
</html>
